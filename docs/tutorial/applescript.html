<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Running AppleScripts &mdash; PyXA 0.1.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Add Items to the Menu Bar" href="menubar.html" />
    <link rel="prev" title="UI Scripting" href="ui_scripting.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyXA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">Project Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#additional-tutorial-topics">Additional Tutorial Topics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="apps/index.html">Application Module Overviews</a></li>
<li class="toctree-l3"><a class="reference internal" href="lists.html">Working With Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="images.html">Working with Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="clipboard.html">Working With The Clipboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_input.html">Getting User Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="spotlight.html">Searching Spotlight</a></li>
<li class="toctree-l3"><a class="reference internal" href="ui_scripting.html">UI Scripting</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Running AppleScripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-and-running-applescript-code">Creating and Running AppleScript Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reading-execution-results">Reading Execution Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loading-external-scripts">Loading External Scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#saving-scripts">Saving Scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="menubar.html">Add Items to the Menu Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="extensions/web/rssfeed.html">Reading RSS Feeds</a></li>
<li class="toctree-l3"><a class="reference internal" href="appscript.html">Using Appscript to Work With Unsupported Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="tips_tricks.html">Tips and Tricks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Code Documentation and Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs.html">Bugs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyXA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorial</a></li>
      <li class="breadcrumb-item active">Running AppleScripts</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/applescript.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="running-applescripts">
<h1>Running AppleScripts<a class="headerlink" href="#running-applescripts" title="Permalink to this heading"></a></h1>
<p>PyXA has a dedicated <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript" title="PyXA.XABase.AppleScript"><code class="xref py py-class docutils literal notranslate"><span class="pre">AppleScript</span></code></a> class which supports several useful features for working with AppleScript scripts. This allows you to run any AppleScript you desire, thereby opening up the entirety of AppleScript’s capabilities to Python.</p>
<section id="creating-and-running-applescript-code">
<h2>Creating and Running AppleScript Code<a class="headerlink" href="#creating-and-running-applescript-code" title="Permalink to this heading"></a></h2>
<p>The easiest way to run AppleScript code on-the-fly is to instantiate an <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript" title="PyXA.XABase.AppleScript"><code class="xref py py-class docutils literal notranslate"><span class="pre">AppleScript</span></code></a> object with the text of the script as an argument. You can run the script using the <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.run" title="PyXA.XABase.AppleScript.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a> method, as seen in the code below. The script won’t run until you tell it to, allowing you to modify the script after instantiation but before execution.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="p">(</span><span class="s2">&quot;tell application </span><span class="se">\&quot;</span><span class="s2">Safari</span><span class="se">\&quot;</span><span class="s2"> to activate&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that if your script includes quoted text, you need to properly escape the quotation marks if using the above format. You can also use triple quotes to preserve the string’s formatting, which allows you to use unescaped quotes and has the added benefit of preserving line breaks. As seen in the example below, this provides an easy way to create and run multiline AppleScripts.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;tell application &quot;Pages&quot;</span>
<span class="s2">    set the miniaturized of window 1 to true</span>
<span class="s2">end tell</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>You can also modify <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript" title="PyXA.XABase.AppleScript"><code class="xref py py-class docutils literal notranslate"><span class="pre">AppleScript</span></code></a> objects after instantiation using the <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.add" title="PyXA.XABase.AppleScript.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a>, <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.insert" title="PyXA.XABase.AppleScript.insert"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert()</span></code></a>, and <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.pop" title="PyXA.XABase.AppleScript.pop"><code class="xref py py-func docutils literal notranslate"><span class="pre">pop()</span></code></a> methods. These provide the ability to dynamically add and remove lines from the script. You can then use Python’s control blocks (such as if/elif/else) to create powerful combinations of Python and AppleScript that utilize the capabilities of both languages. The script below shows a basic implementation of this. The code creates an <a class="reference internal" href="../reference/apps/numbers.html#PyXA.apps.Notes.XANotesApplication" title="PyXA.apps.Notes.XANotesApplication"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyXA.apps.Notes.XANotesApplication</span></code></a> application object to interact with the Notes app and sets up and empty <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript" title="PyXA.XABase.AppleScript"><code class="xref py py-class docutils literal notranslate"><span class="pre">AppleScript</span></code></a> object. We then use combinations of the <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.add" title="PyXA.XABase.AppleScript.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a>, <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.insert" title="PyXA.XABase.AppleScript.insert"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert()</span></code></a>, and <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.pop" title="PyXA.XABase.AppleScript.pop"><code class="xref py py-func docutils literal notranslate"><span class="pre">pop()</span></code></a> methods to construct an AppleScript script. Note how we dynamically construct the AppleScript code based on whether a note with a specific name exists, which we check from within Python. While this particular script is not very useful, you could use this capability to generate lengthy AppleScripts that are specialized to a user’s system, for example.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">application</span><span class="p">(</span><span class="s2">&quot;Notes&quot;</span><span class="p">)</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="p">()</span>
<span class="n">script</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;tell application </span><span class="se">\&quot;</span><span class="s2">Notes</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;end tell&quot;</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

<span class="k">if</span> <span class="s2">&quot;PyXA Ideas&quot;</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">notes</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">():</span>
   <span class="n">script</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;set note1 to the note </span><span class="se">\&quot;</span><span class="s2">PyXA Ideas</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
   <span class="n">script</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;show note1&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
   <span class="n">script</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;error </span><span class="se">\&quot;</span><span class="s2">Could not find the note!</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">script</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>
<span class="c1"># &lt;&lt;class &#39;PyXA.XABase.AppleScript&#39;&gt;[&#39;tell application &quot;Notes&quot;&#39;, &#39;set note1 to the note &quot;PyXA Ideas&quot;&#39;, &#39;show note1&#39;, &#39;end tell&#39;]&gt;</span>
</pre></div>
</div>
</section>
<section id="reading-execution-results">
<h2>Reading Execution Results<a class="headerlink" href="#reading-execution-results" title="Permalink to this heading"></a></h2>
<p>The script contained within an <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript" title="PyXA.XABase.AppleScript"><code class="xref py py-class docutils literal notranslate"><span class="pre">AppleScript</span></code></a> object will execute upon calling the <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.run" title="PyXA.XABase.AppleScript.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a> method, returning a dictionary containing the execution return value of the script. This allows you to further intertwine Python logic with AppleScript. The returned dictionary is structured as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s1">&#39;string&#39;</span><span class="p">:</span> <span class="s1">&#39;Example.txt&#39;</span><span class="p">,</span>
   <span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
   <span class="s1">&#39;bool&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
   <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
   <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
   <span class="s1">&#39;file_url&#39;</span><span class="p">:</span> <span class="n">file</span><span class="p">:</span><span class="o">///</span><span class="n">Users</span><span class="o">/</span><span class="n">exampleUser</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">Example</span><span class="o">.</span><span class="n">txt</span><span class="p">,</span>
   <span class="s1">&#39;type_code&#39;</span><span class="p">:</span> <span class="mi">6881357</span><span class="p">,</span>
   <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">length</span> <span class="o">=</span> <span class="mi">108</span><span class="p">,</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="mh">0x4d006900</span> <span class="mf">6e006500</span> <span class="mi">63007200</span> <span class="mi">61006600</span> <span class="o">...</span> <span class="mi">54007500</span> <span class="mi">62006500</span> <span class="p">},</span>
   <span class="s1">&#39;event&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">NSAppleEventDescriptor</span><span class="p">:</span> <span class="s1">&#39;utxt&#39;</span><span class="p">(</span><span class="s2">&quot;Example.txt&quot;</span><span class="p">)</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This structure provides a convenient way to access the information contained in an execution return value, especially when that data has a well-defined type (such as a string, integer, boolean, float, or date). When the return value is a single string, for example, you can access it by getting the “string” key of the result dictionary, as shown in the example below:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;tell application &quot;Safari&quot; to get the name of window 1&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">script</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">])</span>
<span class="c1"># Running AppleScripts — PyXA 0.0.9 documentation</span>
</pre></div>
</div>
<p>When dealing with other forms of data, such as a list of Safari tab names or the list of IDs of all chats in Messages, you can use the <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.parse_result_data" title="PyXA.XABase.AppleScript.parse_result_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_result_data()</span></code></a> function to extract the text and numbers from the raw Apple Event data. This function takes the results dictionary, isolated the NSAppleEventDescriptor, loops through each sub-descriptor, gets the string value of the descriptor or creates a tuple of the sub-descriptor’s values, then returns a list containing the value or tuple associated with each entry. The first code snippet below shows how to get the names of all Safari tabs, the second shows how to list the ID property of all chats in Messages, and the third shows how to create PyXA objects from the returned data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;tell application &quot;Safari&quot;</span>
<span class="s2">   set tabNames to </span><span class="si">{}</span><span class="s2"></span>
<span class="s2">   repeat with t in tabs of window 1</span>
<span class="s2">      set end of tabNames to (name of t)</span>
<span class="s2">   end repeat</span>
<span class="s2">   return tabNames</span>
<span class="s2">end tell</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">script</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="o">.</span><span class="n">parse_result_data</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
<span class="c1"># [&#39;Google&#39;, &#39;Bing&#39;, &#39;Apple&#39;]</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;tell application &quot;Messages&quot;</span>
<span class="s2">   get chats</span>
<span class="s2">end tell</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">script</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="o">.</span><span class="n">parse_result_data</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
<span class="c1"># [(&#39;ID&#39;, &#39;iMessage;-;+11234567890&#39;), (&#39;ID&#39;, &#39;iMessage;-;+11234567891&#39;), ...]</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">application</span><span class="p">(</span><span class="s2">&quot;Messages&quot;</span><span class="p">)</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;tell application &quot;Messages&quot;</span>
<span class="s2">   get chats</span>
<span class="s2">end tell</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">script</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">entries</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="o">.</span><span class="n">parse_result_data</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">chats</span> <span class="o">=</span> <span class="p">[</span><span class="n">app</span><span class="o">.</span><span class="n">chats</span><span class="p">()</span><span class="o">.</span><span class="n">by_id</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chats</span><span class="p">)</span>
<span class="c1"># [&lt;&lt;class &#39;PyXA.apps.Messages.XAMessagesChat&#39;&gt;&lt;&lt;class &#39;PyXA.apps.Messages.XAMessagesParticipantList&#39;&gt;[&#39;Example Person&#39;]&gt;&gt;, ...]</span>
</pre></div>
</div>
<p>The example above are not particularly useful, as PyXA already provides faster and more straightforward ways to accomplish these tasks. For example, the third example, re-written in PyXA code, is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">application</span><span class="p">(</span><span class="s2">&quot;Messages&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">chats</span><span class="p">()])</span>
</pre></div>
</div>
<p>Still, the ability to convert between AppleScript return values and PyXA object types may be useful in some situations.</p>
</section>
<section id="loading-external-scripts">
<h2>Loading External Scripts<a class="headerlink" href="#loading-external-scripts" title="Permalink to this heading"></a></h2>
<p>PyXA provides a way to load existing AppleScript .scpt files using the <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.load" title="PyXA.XABase.AppleScript.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a> method. Once loaded, the script can be treated like any other <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript" title="PyXA.XABase.AppleScript"><code class="xref py py-class docutils literal notranslate"><span class="pre">AppleScript</span></code></a> object.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/Users/exampleUser/Downloads/Test.scpt&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">script</span><span class="o">.</span><span class="n">run</span><span class="p">())</span>
</pre></div>
</div>
<p>You can even modify the script in the same ways as before:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/Users/exampleUser/Downloads/Test.scpt&quot;</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;set note1 to the note </span><span class="se">\&quot;</span><span class="s2">PyXA Ideas</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;show note1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">script</span><span class="o">.</span><span class="n">run</span><span class="p">())</span>
</pre></div>
</div>
<p>This allows you to run your existing AppleScripts from Python. In combination with the ability to read execution results (see <cite>Reading Execution Results</cite>), the ability to load scripts makes PyXA a powerful yet convenient way to interface between Python and AppleScript, without losing access to your existing library of AppleScript automations.</p>
</section>
<section id="saving-scripts">
<h2>Saving Scripts<a class="headerlink" href="#saving-scripts" title="Permalink to this heading"></a></h2>
<p>Once you’ve created and/or modified a script, you can save it to a .scpt file using the <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.save" title="PyXA.XABase.AppleScript.save"><code class="xref py py-func docutils literal notranslate"><span class="pre">save()</span></code></a> method. If the script was initially loaded from a file, you can call <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.AppleScript.save" title="PyXA.XABase.AppleScript.save"><code class="xref py py-func docutils literal notranslate"><span class="pre">save()</span></code></a> without any arguments – the script will be saved to the existing .scpt file. You can also provide a file path as an argument to instruct PyXA to save the script to a particular destination. Note that the script is compiled before it is saved, so specifying a path to anything other than a .scpt file will result in an unreadable document.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/Users/steven/Downloads/Example.scpt&quot;</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;delay 2&quot;</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;set the miniaturized of window 1 to true&quot;</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyXA</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">AppleScript</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">   tell application &quot;Safari&quot;</span>
<span class="s2">      activate</span>
<span class="s2">   end tell</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">script</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;/Users/exampleUser/Downloads/Example.scpt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ui_scripting.html" class="btn btn-neutral float-left" title="UI Scripting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="menubar.html" class="btn btn-neutral float-right" title="Add Items to the Menu Bar" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Stephen Kaplan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>