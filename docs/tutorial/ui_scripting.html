<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UI Scripting &mdash; PyXA 0.2.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Running AppleScripts" href="applescript.html" />
    <link rel="prev" title="Searching Spotlight" href="spotlight.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyXA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">Project Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#additional-tutorial-topics">Additional Tutorial Topics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="apps/index.html">Application Module Overviews</a></li>
<li class="toctree-l3"><a class="reference internal" href="lists.html">Working With Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="images.html">Working with Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="clipboard.html">Working With The Clipboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_input.html">Getting User Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="spotlight.html">Searching Spotlight</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">UI Scripting</a></li>
<li class="toctree-l3"><a class="reference internal" href="applescript.html">Running AppleScripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="menubar.html">Add Items to the Menu Bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="extensions/web/rssfeed.html">Reading RSS Feeds</a></li>
<li class="toctree-l3"><a class="reference internal" href="appscript.html">Using Appscript to Work With Unsupported Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="tips_tricks.html">Tips and Tricks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Code Documentation and Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs.html">Bugs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyXA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorial</a></li>
      <li class="breadcrumb-item active">UI Scripting</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/ui_scripting.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ui-scripting">
<h1>UI Scripting<a class="headerlink" href="#ui-scripting" title="Permalink to this heading"></a></h1>
<p>PyXA supports using System Events to script the UI of otherwise non-scriptable applications. In fact, PyXA uses this functionality to provide scripting features for several applications, including Maps and Stocks.</p>
<p>The process for scripting an application’s UI starts with getting its window object, from which you can call various methods, such as <a class="reference internal" href="../reference/apps/systemevents.html#PyXA.apps.SystemEvents.XASystemEventsWindow.groups" title="PyXA.apps.SystemEvents.XASystemEventsWindow.groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">groups()</span></code></a> and <a class="reference internal" href="../reference/apps/systemevents.html#PyXA.apps.SystemEvents.XASystemEventsWindow.toolbars" title="PyXA.apps.SystemEvents.XASystemEventsWindow.toolbars"><code class="xref py py-func docutils literal notranslate"><span class="pre">toolbars()</span></code></a>, to obtain lists of UI elements. These methods provide access to all UI element types listed in the System Events scripting dictionary. Lists of elements obtained in this fashion are instances of <a class="reference internal" href="../reference/apps/systemevents.html#PyXA.apps.SystemEvents.XASystemEventsUIElementList" title="PyXA.apps.SystemEvents.XASystemEventsUIElementList"><code class="xref py py-class docutils literal notranslate"><span class="pre">XASystemEventsUIElementList</span></code></a>, a subclass of <a class="reference internal" href="../reference/xabase.html#PyXA.XABase.XAList" title="PyXA.XABase.XAList"><code class="xref py py-class docutils literal notranslate"><span class="pre">XAList</span></code></a>. You can use bulk methods on a list of UI elements to retrieve information about the list’s contents. For example, you can call <a class="reference internal" href="../reference/apps/systemevents.html#PyXA.apps.SystemEvents.XASystemEventsUIElementList.object_description" title="PyXA.apps.SystemEvents.XASystemEventsUIElementList.object_description"><code class="xref py py-func docutils literal notranslate"><span class="pre">object_description()</span></code></a> to get the accessibility or role description of all elements in the list. List filtration methods such as <a class="reference internal" href="../reference/apps/systemevents.html#PyXA.apps.SystemEvents.XASystemEventsUIElementList.by_object_description" title="PyXA.apps.SystemEvents.XASystemEventsUIElementList.by_object_description"><code class="xref py py-func docutils literal notranslate"><span class="pre">by_object_description()</span></code></a> allow you to efficiently access elements with particular property values.</p>
<p>Retrieving an element from an <a class="reference internal" href="../reference/apps/systemevents.html#PyXA.apps.SystemEvents.XASystemEventsUIElementList" title="PyXA.apps.SystemEvents.XASystemEventsUIElementList"><code class="xref py py-class docutils literal notranslate"><span class="pre">XASystemEventsUIElementList</span></code></a> object will return a instance of <a class="reference internal" href="../reference/apps/systemevents.html#PyXA.apps.SystemEvents.XASystemEventsUIElement" title="PyXA.apps.SystemEvents.XASystemEventsUIElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">XASystemEventsUIElement</span></code></a>. You can then obtain the properties of the UI element via the object’s attributes. Upon doing so, the reference to the AppleScript scripting object will be evaluated, causing one or more Apple Events to be sent. This behavior makes it possible to quickly traverse the UI hierarchy without sending unnecessary Apple Events and causing slowdowns.</p>
<p>Once you have a reference to a specific UI element, you can call methods such as <code class="xref py py-func docutils literal notranslate"><span class="pre">click()</span></code> to carry out actions on that element, or you can obtain a list of actions by calling <a class="reference internal" href="../reference/apps/systemevents.html#PyXA.apps.SystemEvents.XASystemEventsUIElement.actions" title="PyXA.apps.SystemEvents.XASystemEventsUIElement.actions"><code class="xref py py-func docutils literal notranslate"><span class="pre">actions()</span></code></a>. Call <a class="reference internal" href="../reference/apps/systemevents.html#PyXA.apps.SystemEvents.XASystemEventsAction.perform" title="PyXA.apps.SystemEvents.XASystemEventsAction.perform"><code class="xref py py-func docutils literal notranslate"><span class="pre">perform()</span></code></a> to perform a particular action.</p>
<p>An example of this process is provided below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="nn">PyXA</span>

<span class="n">podcasts</span> <span class="o">=</span> <span class="n">PyXA</span><span class="o">.</span><span class="n">Application</span><span class="p">(</span><span class="s2">&quot;Podcasts&quot;</span><span class="p">)</span>

<span class="c1"># Get the list of podcast playback controls</span>
<span class="n">playback_buttons</span> <span class="o">=</span> <span class="n">podcasts</span><span class="o">.</span><span class="n">front_window</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">buttons</span><span class="p">()</span>

<span class="c1"># Get buttons by property value</span>
<span class="n">rewind_button</span> <span class="o">=</span> <span class="n">playback_buttons</span><span class="o">.</span><span class="n">by_object_description</span><span class="p">(</span><span class="s2">&quot;Rewind&quot;</span><span class="p">)</span>
<span class="n">play_button</span> <span class="o">=</span> <span class="n">playback_buttons</span><span class="o">.</span><span class="n">by_object_description</span><span class="p">(</span><span class="s2">&quot;Play&quot;</span><span class="p">)</span>
<span class="n">skip_button</span> <span class="o">=</span> <span class="n">playback_buttons</span><span class="o">.</span><span class="n">by_object_description</span><span class="p">(</span><span class="s2">&quot;Skip&quot;</span><span class="p">)</span>

<span class="c1"># Click the buttons</span>
<span class="n">play_button</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
<span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">skip_button</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
<span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rewind_button</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>
</div>
<p>In this example, we obtain a list of buttons by traversing the UI hierarchy of the Podcasts app to reach the specific group containing the rewind, play, and skip forward buttons at the top of the window. You can use macOS’s built-in <cite>Accessibility Inspector</cite> application to help identify the element hierarchy. Once we have the list of buttons, we obtain references to each individual button according to its object description. We then call the <code class="xref py py-func docutils literal notranslate"><span class="pre">click()</span></code> method of each button to observe its effect.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="spotlight.html" class="btn btn-neutral float-left" title="Searching Spotlight" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="applescript.html" class="btn btn-neutral float-right" title="Running AppleScripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Stephen Kaplan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>